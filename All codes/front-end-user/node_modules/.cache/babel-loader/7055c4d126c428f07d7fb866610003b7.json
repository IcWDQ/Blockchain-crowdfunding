{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import'./ProjectCard.css';function ProjectCard(_ref){let{id,name,category,description,projectDDL,status,fundingGoal,amountRaised,onClick,activePage,creator}=_ref;const[milestones,setMilestones]=useState([]);const[currentUser,setCurrentUser]=useState('');useEffect(()=>{const fetchCurrentUser=async()=>{var _accounts$;const accounts=await window.ethereum.request({method:'eth_requestAccounts'});setCurrentUser(((_accounts$=accounts[0])===null||_accounts$===void 0?void 0:_accounts$.toLowerCase())||'');};fetchCurrentUser();},[]);useEffect(()=>{if(status.toLowerCase()==='funded'){fetchMilestones(id);}},[id,status]);const fetchMilestones=async projectId=>{try{const response=await axios.get('/api/milestones',{params:{projectId}});const projectMilestones=response.data.filter(milestone=>milestone.projectId===projectId);setMilestones(projectMilestones);}catch(error){console.error('Error fetching milestones:',error);}};const daysUntilDeadline=(new Date(projectDDL)-new Date())/(1000*60*60*24);const isDeadlineSoon=daysUntilDeadline<=6;const formatDescription=text=>{const maxLength=100;// Adjusted max length for description\nif(text.length>maxLength){return text.substring(0,maxLength-3)+'...';}return text;};const formatTitle=text=>{const maxLength=30;// Adjusted max length for title\nif(text.length>maxLength){return text.substring(0,maxLength-3)+'...';}return text;};const displayedDescription=formatDescription(description);const displayedTitle=formatTitle(name);// Convert fundingGoal to Ether and ensure amountRaised is in Ether\nconst fundingGoalInEther=(fundingGoal/10**18).toString();const amountRaisedInEther=parseFloat(amountRaised).toString();const fundingProgress=parseFloat(amountRaisedInEther)/parseFloat(fundingGoalInEther)*100;// Determine card color based on project status or creator\nconst isCreator=(creator===null||creator===void 0?void 0:creator.toLowerCase())===currentUser;// Check if the current user is the creator\nconst cardColorClass=status.toLowerCase()==='deleted'?'gray':isCreator?'orange':'';return/*#__PURE__*/React.createElement(\"div\",{className:\"project-card \".concat(cardColorClass),onClick:onClick},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"project-name\"},displayedTitle),/*#__PURE__*/React.createElement(\"p\",{className:\"project-id\"},/*#__PURE__*/React.createElement(\"strong\",null,\"ID:\"),\" \",id),/*#__PURE__*/React.createElement(\"p\",{className:\"project-category\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Category:\"),\" \",category)),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"p\",{className:\"project-description\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Description:\"),\" \",displayedDescription),/*#__PURE__*/React.createElement(\"p\",{className:\"project-ddl\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Deadline: \"),/*#__PURE__*/React.createElement(\"span\",{className:\"deadline-date \".concat(isDeadlineSoon?'soon':'')},new Date(projectDDL).toLocaleDateString()))),/*#__PURE__*/React.createElement(\"div\",{className:\"card-footer\"},status.toLowerCase()==='active'?/*#__PURE__*/React.createElement(\"div\",{className:\"status-section\"},/*#__PURE__*/React.createElement(\"p\",{className:\"project-status\"},\"Crowdfunding Project - Raised: \",amountRaisedInEther,\" / \",fundingGoalInEther,\" ETH\"),/*#__PURE__*/React.createElement(\"div\",{className:\"progress-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"progress\",style:{width:\"\".concat(fundingProgress,\"%\")}}))):null,status.toLowerCase()==='funded'&&milestones.length>0?/*#__PURE__*/React.createElement(\"div\",{className:\"milestone-section\"},/*#__PURE__*/React.createElement(\"p\",{className:\"project-status\"},\"Milestone Progress - \",milestones.filter(m=>m.milestonestatus==='approved').length,\" of \",milestones.length,\" approved\"),/*#__PURE__*/React.createElement(\"div\",{className:\"milestone-progress-container\"},milestones.map((milestone,index)=>{const milestoneStatus=milestone.milestonestatus;const isApproved=milestoneStatus==='approved';const isPending=milestoneStatus==='pending';return/*#__PURE__*/React.createElement(\"div\",{key:\"\".concat(id,\"-\").concat(milestone.milestoneId)// Use milestoneId as key\n,className:\"milestone-progress \".concat(isApproved?'approved':isPending?'pending':'upcoming')});}))):null));}export default ProjectCard;","map":{"version":3,"names":["React","useState","useEffect","axios","ProjectCard","_ref","id","name","category","description","projectDDL","status","fundingGoal","amountRaised","onClick","activePage","creator","milestones","setMilestones","currentUser","setCurrentUser","fetchCurrentUser","_accounts$","accounts","window","ethereum","request","method","toLowerCase","fetchMilestones","projectId","response","get","params","projectMilestones","data","filter","milestone","error","console","daysUntilDeadline","Date","isDeadlineSoon","formatDescription","text","maxLength","length","substring","formatTitle","displayedDescription","displayedTitle","fundingGoalInEther","toString","amountRaisedInEther","parseFloat","fundingProgress","isCreator","cardColorClass","createElement","className","concat","toLocaleDateString","style","width","m","milestonestatus","map","index","milestoneStatus","isApproved","isPending","key","milestoneId"],"sources":["/Users/matrix/front-end/src/components/ProjectCard/ProjectCard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport './ProjectCard.css';\n\nfunction ProjectCard({ id, name, category, description, projectDDL, status, fundingGoal, amountRaised, onClick, activePage, creator }) {\n  const [milestones, setMilestones] = useState([]);\n  const [currentUser, setCurrentUser] = useState('');\n\n  useEffect(() => {\n    const fetchCurrentUser = async () => {\n      const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n      setCurrentUser(accounts[0]?.toLowerCase() || '');\n    };\n    fetchCurrentUser();\n  }, []);\n\n  useEffect(() => {\n    if (status.toLowerCase() === 'funded') {\n      fetchMilestones(id);\n    }\n  }, [id, status]);\n\n  const fetchMilestones = async (projectId) => {\n    try {\n      const response = await axios.get('/api/milestones', {\n        params: { projectId }\n      });\n      const projectMilestones = response.data.filter(milestone => milestone.projectId === projectId);\n      setMilestones(projectMilestones);\n    } catch (error) {\n      console.error('Error fetching milestones:', error);\n    }\n  };\n\n  const daysUntilDeadline = (new Date(projectDDL) - new Date()) / (1000 * 60 * 60 * 24);\n  const isDeadlineSoon = daysUntilDeadline <= 6;\n\n  const formatDescription = (text) => {\n    const maxLength = 100; // Adjusted max length for description\n    if (text.length > maxLength) {\n      return text.substring(0, maxLength - 3) + '...';\n    }\n    return text;\n  };\n\n  const formatTitle = (text) => {\n    const maxLength = 30; // Adjusted max length for title\n    if (text.length > maxLength) {\n      return text.substring(0, maxLength - 3) + '...';\n    }\n    return text;\n  };\n\n  const displayedDescription = formatDescription(description);\n  const displayedTitle = formatTitle(name);\n\n  // Convert fundingGoal to Ether and ensure amountRaised is in Ether\n  const fundingGoalInEther = (fundingGoal / 10 ** 18).toString();\n  const amountRaisedInEther = parseFloat(amountRaised).toString();\n\n  const fundingProgress = (parseFloat(amountRaisedInEther) / parseFloat(fundingGoalInEther)) * 100;\n\n  // Determine card color based on project status or creator\n  const isCreator = creator?.toLowerCase() === currentUser; // Check if the current user is the creator\n  const cardColorClass = status.toLowerCase() === 'deleted' ? 'gray' : (isCreator ? 'orange' : '');\n\n  return (\n    <div className={`project-card ${cardColorClass}`} onClick={onClick}>\n      <div className=\"card-header\">\n        <h3 className=\"project-name\">{displayedTitle}</h3>\n        <p className=\"project-id\"><strong>ID:</strong> {id}</p>\n        <p className=\"project-category\"><strong>Category:</strong> {category}</p>\n      </div>\n      <div className=\"card-body\">\n        <p className=\"project-description\">\n          <strong>Description:</strong> {displayedDescription}\n        </p>\n        <p className=\"project-ddl\">\n          <strong>Deadline: </strong>\n          <span className={`deadline-date ${isDeadlineSoon ? 'soon' : ''}`}>\n            {new Date(projectDDL).toLocaleDateString()}\n          </span>\n        </p>\n      </div>\n      <div className=\"card-footer\">\n        {status.toLowerCase() === 'active' ? (\n          <div className=\"status-section\">\n            <p className=\"project-status\">Crowdfunding Project - Raised: {amountRaisedInEther} / {fundingGoalInEther} ETH</p>\n            <div className=\"progress-bar\">\n              <div className=\"progress\" style={{ width: `${fundingProgress}%` }}></div>\n            </div>\n          </div>\n        ) : null}\n\n        {status.toLowerCase() === 'funded' && milestones.length > 0 ? (\n          <div className=\"milestone-section\">\n            <p className=\"project-status\">Milestone Progress - {milestones.filter(m => m.milestonestatus === 'approved').length} of {milestones.length} approved</p>\n            <div className=\"milestone-progress-container\">\n              {milestones.map((milestone, index) => {\n                const milestoneStatus = milestone.milestonestatus;\n                const isApproved = milestoneStatus === 'approved';\n                const isPending = milestoneStatus === 'pending';\n                return (\n                  <div\n                    key={`${id}-${milestone.milestoneId}`} // Use milestoneId as key\n                    className={`milestone-progress ${isApproved ? 'approved' : isPending ? 'pending' : 'upcoming'}`}\n                  ></div>\n                );\n              })}\n            </div>\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nexport default ProjectCard;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,mBAAmB,CAE1B,QAAS,CAAAC,WAAWA,CAAAC,IAAA,CAAmH,IAAlH,CAAEC,EAAE,CAAEC,IAAI,CAAEC,QAAQ,CAAEC,WAAW,CAAEC,UAAU,CAAEC,MAAM,CAAEC,WAAW,CAAEC,YAAY,CAAEC,OAAO,CAAEC,UAAU,CAAEC,OAAQ,CAAC,CAAAX,IAAA,CACnI,KAAM,CAACY,UAAU,CAAEC,aAAa,CAAC,CAAGjB,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACkB,WAAW,CAAEC,cAAc,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CAElDC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAmB,gBAAgB,CAAG,KAAAA,CAAA,GAAY,KAAAC,UAAA,CACnC,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,CAAEC,MAAM,CAAE,qBAAsB,CAAC,CAAC,CACjFP,cAAc,CAAC,EAAAE,UAAA,CAAAC,QAAQ,CAAC,CAAC,CAAC,UAAAD,UAAA,iBAAXA,UAAA,CAAaM,WAAW,CAAC,CAAC,GAAI,EAAE,CAAC,CAClD,CAAC,CACDP,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAAE,EAAE,CAAC,CAENnB,SAAS,CAAC,IAAM,CACd,GAAIS,MAAM,CAACiB,WAAW,CAAC,CAAC,GAAK,QAAQ,CAAE,CACrCC,eAAe,CAACvB,EAAE,CAAC,CACrB,CACF,CAAC,CAAE,CAACA,EAAE,CAAEK,MAAM,CAAC,CAAC,CAEhB,KAAM,CAAAkB,eAAe,CAAG,KAAO,CAAAC,SAAS,EAAK,CAC3C,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAA5B,KAAK,CAAC6B,GAAG,CAAC,iBAAiB,CAAE,CAClDC,MAAM,CAAE,CAAEH,SAAU,CACtB,CAAC,CAAC,CACF,KAAM,CAAAI,iBAAiB,CAAGH,QAAQ,CAACI,IAAI,CAACC,MAAM,CAACC,SAAS,EAAIA,SAAS,CAACP,SAAS,GAAKA,SAAS,CAAC,CAC9FZ,aAAa,CAACgB,iBAAiB,CAAC,CAClC,CAAE,MAAOI,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CACpD,CACF,CAAC,CAED,KAAM,CAAAE,iBAAiB,CAAG,CAAC,GAAI,CAAAC,IAAI,CAAC/B,UAAU,CAAC,CAAG,GAAI,CAAA+B,IAAI,CAAC,CAAC,GAAK,IAAI,CAAG,EAAE,CAAG,EAAE,CAAG,EAAE,CAAC,CACrF,KAAM,CAAAC,cAAc,CAAGF,iBAAiB,EAAI,CAAC,CAE7C,KAAM,CAAAG,iBAAiB,CAAIC,IAAI,EAAK,CAClC,KAAM,CAAAC,SAAS,CAAG,GAAG,CAAE;AACvB,GAAID,IAAI,CAACE,MAAM,CAAGD,SAAS,CAAE,CAC3B,MAAO,CAAAD,IAAI,CAACG,SAAS,CAAC,CAAC,CAAEF,SAAS,CAAG,CAAC,CAAC,CAAG,KAAK,CACjD,CACA,MAAO,CAAAD,IAAI,CACb,CAAC,CAED,KAAM,CAAAI,WAAW,CAAIJ,IAAI,EAAK,CAC5B,KAAM,CAAAC,SAAS,CAAG,EAAE,CAAE;AACtB,GAAID,IAAI,CAACE,MAAM,CAAGD,SAAS,CAAE,CAC3B,MAAO,CAAAD,IAAI,CAACG,SAAS,CAAC,CAAC,CAAEF,SAAS,CAAG,CAAC,CAAC,CAAG,KAAK,CACjD,CACA,MAAO,CAAAD,IAAI,CACb,CAAC,CAED,KAAM,CAAAK,oBAAoB,CAAGN,iBAAiB,CAAClC,WAAW,CAAC,CAC3D,KAAM,CAAAyC,cAAc,CAAGF,WAAW,CAACzC,IAAI,CAAC,CAExC;AACA,KAAM,CAAA4C,kBAAkB,CAAG,CAACvC,WAAW,CAAG,EAAE,EAAI,EAAE,EAAEwC,QAAQ,CAAC,CAAC,CAC9D,KAAM,CAAAC,mBAAmB,CAAGC,UAAU,CAACzC,YAAY,CAAC,CAACuC,QAAQ,CAAC,CAAC,CAE/D,KAAM,CAAAG,eAAe,CAAID,UAAU,CAACD,mBAAmB,CAAC,CAAGC,UAAU,CAACH,kBAAkB,CAAC,CAAI,GAAG,CAEhG;AACA,KAAM,CAAAK,SAAS,CAAG,CAAAxC,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEY,WAAW,CAAC,CAAC,IAAKT,WAAW,CAAE;AAC1D,KAAM,CAAAsC,cAAc,CAAG9C,MAAM,CAACiB,WAAW,CAAC,CAAC,GAAK,SAAS,CAAG,MAAM,CAAI4B,SAAS,CAAG,QAAQ,CAAG,EAAG,CAEhG,mBACExD,KAAA,CAAA0D,aAAA,QAAKC,SAAS,iBAAAC,MAAA,CAAkBH,cAAc,CAAG,CAAC3C,OAAO,CAAEA,OAAQ,eACjEd,KAAA,CAAA0D,aAAA,QAAKC,SAAS,CAAC,aAAa,eAC1B3D,KAAA,CAAA0D,aAAA,OAAIC,SAAS,CAAC,cAAc,EAAET,cAAmB,CAAC,cAClDlD,KAAA,CAAA0D,aAAA,MAAGC,SAAS,CAAC,YAAY,eAAC3D,KAAA,CAAA0D,aAAA,eAAQ,KAAW,CAAC,IAAC,CAACpD,EAAM,CAAC,cACvDN,KAAA,CAAA0D,aAAA,MAAGC,SAAS,CAAC,kBAAkB,eAAC3D,KAAA,CAAA0D,aAAA,eAAQ,WAAiB,CAAC,IAAC,CAAClD,QAAY,CACrE,CAAC,cACNR,KAAA,CAAA0D,aAAA,QAAKC,SAAS,CAAC,WAAW,eACxB3D,KAAA,CAAA0D,aAAA,MAAGC,SAAS,CAAC,qBAAqB,eAChC3D,KAAA,CAAA0D,aAAA,eAAQ,cAAoB,CAAC,IAAC,CAACT,oBAC9B,CAAC,cACJjD,KAAA,CAAA0D,aAAA,MAAGC,SAAS,CAAC,aAAa,eACxB3D,KAAA,CAAA0D,aAAA,eAAQ,YAAkB,CAAC,cAC3B1D,KAAA,CAAA0D,aAAA,SAAMC,SAAS,kBAAAC,MAAA,CAAmBlB,cAAc,CAAG,MAAM,CAAG,EAAE,CAAG,EAC9D,GAAI,CAAAD,IAAI,CAAC/B,UAAU,CAAC,CAACmD,kBAAkB,CAAC,CACrC,CACL,CACA,CAAC,cACN7D,KAAA,CAAA0D,aAAA,QAAKC,SAAS,CAAC,aAAa,EACzBhD,MAAM,CAACiB,WAAW,CAAC,CAAC,GAAK,QAAQ,cAChC5B,KAAA,CAAA0D,aAAA,QAAKC,SAAS,CAAC,gBAAgB,eAC7B3D,KAAA,CAAA0D,aAAA,MAAGC,SAAS,CAAC,gBAAgB,EAAC,iCAA+B,CAACN,mBAAmB,CAAC,KAAG,CAACF,kBAAkB,CAAC,MAAO,CAAC,cACjHnD,KAAA,CAAA0D,aAAA,QAAKC,SAAS,CAAC,cAAc,eAC3B3D,KAAA,CAAA0D,aAAA,QAAKC,SAAS,CAAC,UAAU,CAACG,KAAK,CAAE,CAAEC,KAAK,IAAAH,MAAA,CAAKL,eAAe,KAAI,CAAE,CAAM,CACrE,CACF,CAAC,CACJ,IAAI,CAEP5C,MAAM,CAACiB,WAAW,CAAC,CAAC,GAAK,QAAQ,EAAIX,UAAU,CAAC6B,MAAM,CAAG,CAAC,cACzD9C,KAAA,CAAA0D,aAAA,QAAKC,SAAS,CAAC,mBAAmB,eAChC3D,KAAA,CAAA0D,aAAA,MAAGC,SAAS,CAAC,gBAAgB,EAAC,uBAAqB,CAAC1C,UAAU,CAACmB,MAAM,CAAC4B,CAAC,EAAIA,CAAC,CAACC,eAAe,GAAK,UAAU,CAAC,CAACnB,MAAM,CAAC,MAAI,CAAC7B,UAAU,CAAC6B,MAAM,CAAC,WAAY,CAAC,cACxJ9C,KAAA,CAAA0D,aAAA,QAAKC,SAAS,CAAC,8BAA8B,EAC1C1C,UAAU,CAACiD,GAAG,CAAC,CAAC7B,SAAS,CAAE8B,KAAK,GAAK,CACpC,KAAM,CAAAC,eAAe,CAAG/B,SAAS,CAAC4B,eAAe,CACjD,KAAM,CAAAI,UAAU,CAAGD,eAAe,GAAK,UAAU,CACjD,KAAM,CAAAE,SAAS,CAAGF,eAAe,GAAK,SAAS,CAC/C,mBACEpE,KAAA,CAAA0D,aAAA,QACEa,GAAG,IAAAX,MAAA,CAAKtD,EAAE,MAAAsD,MAAA,CAAIvB,SAAS,CAACmC,WAAW,CAAI;AAAA,CACvCb,SAAS,uBAAAC,MAAA,CAAwBS,UAAU,CAAG,UAAU,CAAGC,SAAS,CAAG,SAAS,CAAG,UAAU,CAAG,CAC5F,CAAC,CAEX,CAAC,CACE,CACF,CAAC,CACJ,IACD,CACF,CAAC,CAEV,CAEA,cAAe,CAAAlE,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module"}