{"ast":null,"code":"var _jsxFileName = \"/Users/matrix/front-end/src/components/Home/Home.js\";\n// src/components/Home/Home.js\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { ethers } from 'ethers';\nimport Navbar from '../Navbar/Navbar';\nimport ProjectList from '../ProjectList/ProjectList';\nimport ProjectDetails from '../ProjectDetails/ProjectDetails';\nimport CreateProject from '../CreateProject/CreateProject';\nimport './Home.css';\nfunction Home() {\n  const [projects, setProjects] = useState([]);\n  const [filteredProjects, setFilteredProjects] = useState([]);\n  const [userAddress, setUserAddress] = useState('');\n  const [selectedProject, setSelectedProject] = useState(null);\n  const [activePage, setActivePage] = useState('allProjects');\n  useEffect(() => {\n    fetchProjects();\n    getUserAddress();\n  }, []);\n  const fetchProjects = async () => {\n    try {\n      const response = await axios.get('/api/projects');\n      setProjects(response.data);\n      setFilteredProjects(response.data);\n    } catch (error) {\n      console.error('Error fetching projects:', error);\n    }\n  };\n  const getUserAddress = async () => {\n    try {\n      await window.ethereum.request({\n        method: 'eth_requestAccounts'\n      });\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const address = await signer.getAddress();\n      setUserAddress(address);\n    } catch (error) {\n      console.error('Error getting user address:', error);\n    }\n  };\n  const filterMyProjects = () => {\n    return projects.filter(project => project.creator.toLowerCase() === userAddress.toLowerCase());\n  };\n  const filterFundedProjects = () => {\n    return projects.filter(project => (project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded') && project.contributors.some(contributor => contributor.toLowerCase() === userAddress.toLowerCase()));\n  };\n  const filterActiveAndFundedProjects = () => {\n    return projects.filter(project => project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded');\n  };\n  const toggleCreateProject = () => {\n    setActivePage('createProject');\n    setSelectedProject(null);\n  };\n  const showAllProjects = () => {\n    const activeAndFundedProjects = filterActiveAndFundedProjects();\n    setActivePage('allProjects');\n    setSelectedProject(null);\n    setFilteredProjects(activeAndFundedProjects);\n  };\n  const showMyProjects = () => {\n    const myProjects = filterMyProjects();\n    setActivePage('myProjects');\n    setSelectedProject(null);\n    setFilteredProjects(myProjects);\n  };\n  const showFundedProjects = () => {\n    const fundedProjects = filterFundedProjects();\n    setActivePage('fundedProjects');\n    setSelectedProject(null);\n    setFilteredProjects(fundedProjects);\n  };\n  const handleProjectClick = project => {\n    setSelectedProject({\n      ...project,\n      isCreator: project.creator.toLowerCase() === userAddress.toLowerCase()\n    });\n    setActivePage('projectDetails');\n  };\n  const handleBackToProjects = () => {\n    setSelectedProject(null);\n    setActivePage(activePage === 'createProject' ? 'createProject' : 'allProjects');\n  };\n  const handleSearch = term => {\n    let projectsToFilter = projects;\n    if (activePage === 'myProjects') {\n      projectsToFilter = filterMyProjects();\n    } else if (activePage === 'fundedProjects') {\n      projectsToFilter = filterFundedProjects();\n    } else if (activePage === 'allProjects') {\n      projectsToFilter = filterActiveAndFundedProjects();\n    }\n    if (!term) {\n      setFilteredProjects(projectsToFilter);\n    } else {\n      const lowercasedTerm = term.toLowerCase();\n      const filtered = projectsToFilter.filter(project => project.projectName.toLowerCase().includes(lowercasedTerm) || project.projectId.toString() === term // 精确匹配ID\n      );\n      setFilteredProjects(filtered);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"home-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    onCreateProject: toggleCreateProject,\n    onShowAllProjects: showAllProjects,\n    onShowMyProjects: showMyProjects,\n    onShowFundedProjects: showFundedProjects,\n    onSearch: handleSearch,\n    activePage: activePage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: `content ${activePage === 'createProject' ? 'centered' : ''}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, selectedProject ? /*#__PURE__*/React.createElement(ProjectDetails, {\n    project: selectedProject,\n    onClose: handleBackToProjects,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 11\n    }\n  }) : activePage === 'createProject' ? /*#__PURE__*/React.createElement(CreateProject, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(ProjectList, {\n    projects: filteredProjects,\n    onProjectClick: handleProjectClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }\n  })));\n}\nexport default Home;","map":{"version":3,"names":["React","useState","useEffect","axios","ethers","Navbar","ProjectList","ProjectDetails","CreateProject","Home","projects","setProjects","filteredProjects","setFilteredProjects","userAddress","setUserAddress","selectedProject","setSelectedProject","activePage","setActivePage","fetchProjects","getUserAddress","response","get","data","error","console","window","ethereum","request","method","provider","providers","Web3Provider","signer","getSigner","address","getAddress","filterMyProjects","filter","project","creator","toLowerCase","filterFundedProjects","status","contributors","some","contributor","filterActiveAndFundedProjects","toggleCreateProject","showAllProjects","activeAndFundedProjects","showMyProjects","myProjects","showFundedProjects","fundedProjects","handleProjectClick","isCreator","handleBackToProjects","handleSearch","term","projectsToFilter","lowercasedTerm","filtered","projectName","includes","projectId","toString","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onCreateProject","onShowAllProjects","onShowMyProjects","onShowFundedProjects","onSearch","onClose","onProjectClick"],"sources":["/Users/matrix/front-end/src/components/Home/Home.js"],"sourcesContent":["// src/components/Home/Home.js\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { ethers } from 'ethers';\nimport Navbar from '../Navbar/Navbar';\nimport ProjectList from '../ProjectList/ProjectList';\nimport ProjectDetails from '../ProjectDetails/ProjectDetails';\nimport CreateProject from '../CreateProject/CreateProject';\nimport './Home.css';\n\nfunction Home() {\n  const [projects, setProjects] = useState([]);\n  const [filteredProjects, setFilteredProjects] = useState([]);\n  const [userAddress, setUserAddress] = useState('');\n  const [selectedProject, setSelectedProject] = useState(null);\n  const [activePage, setActivePage] = useState('allProjects');\n\n  useEffect(() => {\n    fetchProjects();\n    getUserAddress();\n  }, []);\n\n  const fetchProjects = async () => {\n    try {\n      const response = await axios.get('/api/projects');\n      setProjects(response.data);\n      setFilteredProjects(response.data);\n    } catch (error) {\n      console.error('Error fetching projects:', error);\n    }\n  };\n\n  const getUserAddress = async () => {\n    try {\n      await window.ethereum.request({ method: 'eth_requestAccounts' });\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const address = await signer.getAddress();\n      setUserAddress(address);\n    } catch (error) {\n      console.error('Error getting user address:', error);\n    }\n  };\n\n  const filterMyProjects = () => {\n    return projects.filter(project => project.creator.toLowerCase() === userAddress.toLowerCase());\n  };\n\n  const filterFundedProjects = () => {\n    return projects.filter(project => \n      (project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded') &&\n      project.contributors.some(contributor => contributor.toLowerCase() === userAddress.toLowerCase())\n    );\n  };\n\n  const filterActiveAndFundedProjects = () => {\n    return projects.filter(project => \n      project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded'\n    );\n  };\n\n  const toggleCreateProject = () => {\n    setActivePage('createProject');\n    setSelectedProject(null);\n  };\n\n  const showAllProjects = () => {\n    const activeAndFundedProjects = filterActiveAndFundedProjects();\n    setActivePage('allProjects');\n    setSelectedProject(null);\n    setFilteredProjects(activeAndFundedProjects);\n  };\n\n  const showMyProjects = () => {\n    const myProjects = filterMyProjects();\n    setActivePage('myProjects');\n    setSelectedProject(null);\n    setFilteredProjects(myProjects);\n  };\n\n  const showFundedProjects = () => {\n    const fundedProjects = filterFundedProjects();\n    setActivePage('fundedProjects');\n    setSelectedProject(null);\n    setFilteredProjects(fundedProjects);\n  };\n\n  const handleProjectClick = (project) => {\n    setSelectedProject({\n      ...project,\n      isCreator: project.creator.toLowerCase() === userAddress.toLowerCase()\n    });\n    setActivePage('projectDetails');\n  };\n\n  const handleBackToProjects = () => {\n    setSelectedProject(null);\n    setActivePage(activePage === 'createProject' ? 'createProject' : 'allProjects');\n  };\n\n  const handleSearch = (term) => {\n    let projectsToFilter = projects;\n    if (activePage === 'myProjects') {\n      projectsToFilter = filterMyProjects();\n    } else if (activePage === 'fundedProjects') {\n      projectsToFilter = filterFundedProjects();\n    } else if (activePage === 'allProjects') {\n      projectsToFilter = filterActiveAndFundedProjects();\n    }\n\n    if (!term) {\n      setFilteredProjects(projectsToFilter);\n    } else {\n      const lowercasedTerm = term.toLowerCase();\n      const filtered = projectsToFilter.filter(project =>\n        project.projectName.toLowerCase().includes(lowercasedTerm) ||\n        project.projectId.toString() === term // 精确匹配ID\n      );\n      setFilteredProjects(filtered);\n    }\n  };\n\n  return (\n    <div className=\"home-container\">\n      <Navbar \n        onCreateProject={toggleCreateProject} \n        onShowAllProjects={showAllProjects} \n        onShowMyProjects={showMyProjects}\n        onShowFundedProjects={showFundedProjects}\n        onSearch={handleSearch}\n        activePage={activePage}\n      />\n      <div className={`content ${activePage === 'createProject' ? 'centered' : ''}`}>\n        {selectedProject ? (\n          <ProjectDetails project={selectedProject} onClose={handleBackToProjects} />\n        ) : activePage === 'createProject' ? (\n          <CreateProject />\n        ) : (\n          <ProjectList projects={filteredProjects} onProjectClick={handleProjectClick} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Home;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}