{"ast":null,"code":"var _jsxFileName = \"/Users/matrix/front-end/src/components/Home/Home.js\";\nimport React, { useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport { ethers } from 'ethers';\nimport Navbar from '../Navbar/Navbar';\nimport ProjectList from '../ProjectList/ProjectList';\nimport ProjectDetails from '../ProjectDetails/ProjectDetails';\nimport CreateProject from '../CreateProject/CreateProject';\nimport './Home.css';\nfunction Home() {\n  const [projects, setProjects] = useState([]);\n  const [filteredProjects, setFilteredProjects] = useState([]);\n  const [userAddress, setUserAddress] = useState('');\n  const [selectedProject, setSelectedProject] = useState(null);\n  const [activePage, setActivePage] = useState('allProjects');\n  const fetchProjects = async () => {\n    try {\n      const response = await axios.get('/api/projects');\n      setProjects(response.data);\n    } catch (error) {\n      console.error('Error fetching projects:', error);\n    }\n  };\n  const getUserAddress = async () => {\n    try {\n      await window.ethereum.request({\n        method: 'eth_requestAccounts'\n      });\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const address = await signer.getAddress();\n      setUserAddress(address.toLowerCase());\n    } catch (error) {\n      console.error('Error getting user address:', error);\n    }\n  };\n  useEffect(() => {\n    fetchProjects();\n    getUserAddress();\n  }, []);\n  const filterMyProjects = useCallback(() => {\n    return projects.filter(project => project.creator.toLowerCase() === userAddress);\n  }, [projects, userAddress]);\n  const filterFundedProjects = useCallback(() => {\n    return projects.filter(project => (project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded') && project.contributors.some(contributor => contributor.toLowerCase() === userAddress));\n  }, [projects, userAddress]);\n  const filterActiveAndFundedProjects = useCallback(() => {\n    return projects.filter(project => project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded');\n  }, [projects]);\n  useEffect(() => {\n    if (activePage === 'allProjects') {\n      setFilteredProjects(filterActiveAndFundedProjects());\n    } else if (activePage === 'fundedProjects') {\n      setFilteredProjects(filterFundedProjects());\n    } else if (activePage === 'myProjects') {\n      setFilteredProjects(filterMyProjects());\n    }\n  }, [projects, activePage, userAddress, filterActiveAndFundedProjects, filterFundedProjects, filterMyProjects]);\n  const toggleCreateProject = () => {\n    setActivePage('createProject');\n    setSelectedProject(null);\n  };\n  const showAllProjects = () => {\n    setActivePage('allProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n  const showMyProjects = () => {\n    setActivePage('myProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n  const showFundedProjects = () => {\n    setActivePage('fundedProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n  const handleProjectClick = project => {\n    setSelectedProject({\n      ...project,\n      isCreator: project.creator.toLowerCase() === userAddress\n    });\n    setActivePage('projectDetails');\n  };\n  const handleBackToProjects = () => {\n    setSelectedProject(null);\n    setActivePage('allProjects');\n  };\n  const handleSearch = term => {\n    let projectsToFilter = projects;\n    if (activePage === 'myProjects') {\n      projectsToFilter = filterMyProjects();\n    } else if (activePage === 'fundedProjects') {\n      projectsToFilter = filterFundedProjects();\n    } else if (activePage === 'allProjects') {\n      projectsToFilter = filterActiveAndFundedProjects();\n    }\n    if (!term) {\n      setFilteredProjects(projectsToFilter);\n    } else {\n      const lowercasedTerm = term.toLowerCase();\n      const filtered = projectsToFilter.filter(project => project.projectName.toLowerCase().includes(lowercasedTerm) || project.projectId.toString() === term // 精确匹配ID\n      );\n      setFilteredProjects(filtered);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"home-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    onCreateProject: toggleCreateProject,\n    onShowAllProjects: showAllProjects,\n    onShowMyProjects: showMyProjects,\n    onShowFundedProjects: showFundedProjects,\n    onSearch: handleSearch,\n    activePage: activePage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: `content ${activePage === 'createProject' ? 'centered' : ''}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }, selectedProject ? /*#__PURE__*/React.createElement(ProjectDetails, {\n    project: selectedProject,\n    onClose: handleBackToProjects,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 11\n    }\n  }) : activePage === 'createProject' ? /*#__PURE__*/React.createElement(CreateProject, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(ProjectList, {\n    projects: filteredProjects,\n    onProjectClick: handleProjectClick,\n    activePage: activePage,\n    currentUser: userAddress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  })));\n}\nexport default Home;","map":{"version":3,"names":["React","useState","useEffect","useCallback","axios","ethers","Navbar","ProjectList","ProjectDetails","CreateProject","Home","projects","setProjects","filteredProjects","setFilteredProjects","userAddress","setUserAddress","selectedProject","setSelectedProject","activePage","setActivePage","fetchProjects","response","get","data","error","console","getUserAddress","window","ethereum","request","method","provider","providers","Web3Provider","signer","getSigner","address","getAddress","toLowerCase","filterMyProjects","filter","project","creator","filterFundedProjects","status","contributors","some","contributor","filterActiveAndFundedProjects","toggleCreateProject","showAllProjects","showMyProjects","showFundedProjects","handleProjectClick","isCreator","handleBackToProjects","handleSearch","term","projectsToFilter","lowercasedTerm","filtered","projectName","includes","projectId","toString","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onCreateProject","onShowAllProjects","onShowMyProjects","onShowFundedProjects","onSearch","onClose","onProjectClick","currentUser"],"sources":["/Users/matrix/front-end/src/components/Home/Home.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport { ethers } from 'ethers';\nimport Navbar from '../Navbar/Navbar';\nimport ProjectList from '../ProjectList/ProjectList';\nimport ProjectDetails from '../ProjectDetails/ProjectDetails';\nimport CreateProject from '../CreateProject/CreateProject';\nimport './Home.css';\n\nfunction Home() {\n  const [projects, setProjects] = useState([]);\n  const [filteredProjects, setFilteredProjects] = useState([]);\n  const [userAddress, setUserAddress] = useState('');\n  const [selectedProject, setSelectedProject] = useState(null);\n  const [activePage, setActivePage] = useState('allProjects');\n\n  const fetchProjects = async () => {\n    try {\n      const response = await axios.get('/api/projects');\n      setProjects(response.data);\n    } catch (error) {\n      console.error('Error fetching projects:', error);\n    }\n  };\n\n  const getUserAddress = async () => {\n    try {\n      await window.ethereum.request({ method: 'eth_requestAccounts' });\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const address = await signer.getAddress();\n      setUserAddress(address.toLowerCase());\n    } catch (error) {\n      console.error('Error getting user address:', error);\n    }\n  };\n\n  useEffect(() => {\n    fetchProjects();\n    getUserAddress();\n  }, []);\n\n  const filterMyProjects = useCallback(() => {\n    return projects.filter(project => project.creator.toLowerCase() === userAddress);\n  }, [projects, userAddress]);\n\n  const filterFundedProjects = useCallback(() => {\n    return projects.filter(project => \n      (project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded') &&\n      project.contributors.some(contributor => contributor.toLowerCase() === userAddress)\n    );\n  }, [projects, userAddress]);\n\n  const filterActiveAndFundedProjects = useCallback(() => {\n    return projects.filter(project => \n      project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded'\n    );\n  }, [projects]);\n\n  useEffect(() => {\n    if (activePage === 'allProjects') {\n      setFilteredProjects(filterActiveAndFundedProjects());\n    } else if (activePage === 'fundedProjects') {\n      setFilteredProjects(filterFundedProjects());\n    } else if (activePage === 'myProjects') {\n      setFilteredProjects(filterMyProjects());\n    }\n  }, [projects, activePage, userAddress, filterActiveAndFundedProjects, filterFundedProjects, filterMyProjects]);\n\n  const toggleCreateProject = () => {\n    setActivePage('createProject');\n    setSelectedProject(null);\n  };\n\n  const showAllProjects = () => {\n    setActivePage('allProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n\n  const showMyProjects = () => {\n    setActivePage('myProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n\n  const showFundedProjects = () => {\n    setActivePage('fundedProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n\n  const handleProjectClick = (project) => {\n    setSelectedProject({\n      ...project,\n      isCreator: project.creator.toLowerCase() === userAddress\n    });\n    setActivePage('projectDetails');\n  };\n\n  const handleBackToProjects = () => {\n    setSelectedProject(null);\n    setActivePage('allProjects');\n  };\n\n  const handleSearch = (term) => {\n    let projectsToFilter = projects;\n    if (activePage === 'myProjects') {\n      projectsToFilter = filterMyProjects();\n    } else if (activePage === 'fundedProjects') {\n      projectsToFilter = filterFundedProjects();\n    } else if (activePage === 'allProjects') {\n      projectsToFilter = filterActiveAndFundedProjects();\n    }\n\n    if (!term) {\n      setFilteredProjects(projectsToFilter);\n    } else {\n      const lowercasedTerm = term.toLowerCase();\n      const filtered = projectsToFilter.filter(project =>\n        project.projectName.toLowerCase().includes(lowercasedTerm) ||\n        project.projectId.toString() === term // 精确匹配ID\n      );\n      setFilteredProjects(filtered);\n    }\n  };\n\n  return (\n    <div className=\"home-container\">\n      <Navbar \n        onCreateProject={toggleCreateProject} \n        onShowAllProjects={showAllProjects} \n        onShowMyProjects={showMyProjects}\n        onShowFundedProjects={showFundedProjects}\n        onSearch={handleSearch}\n        activePage={activePage}\n      />\n      <div className={`content ${activePage === 'createProject' ? 'centered' : ''}`}>\n        {selectedProject ? (\n          <ProjectDetails project={selectedProject} onClose={handleBackToProjects} />\n        ) : activePage === 'createProject' ? (\n          <CreateProject />\n        ) : (\n          <ProjectList projects={filteredProjects} onProjectClick={handleProjectClick} activePage={activePage} currentUser={userAddress} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Home;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}