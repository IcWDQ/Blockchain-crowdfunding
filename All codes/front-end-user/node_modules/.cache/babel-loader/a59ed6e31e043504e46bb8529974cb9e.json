{"ast":null,"code":"import React,{useEffect,useState,useCallback}from'react';import axios from'axios';import FundProject from'../FundProject/FundProject';import UserUploadProof from'../UserUploadProof/UserUploadProof';import'./ProjectDetails.css';function ProjectDetails(_ref){let{project,onClose,activePage}=_ref;const[milestones,setMilestones]=useState([]);const[currentUser,setCurrentUser]=useState('');const fetchCurrentUser=async()=>{try{const accounts=await window.ethereum.request({method:'eth_requestAccounts'});setCurrentUser(accounts[0].toLowerCase());}catch(error){console.error('Error fetching current user:',error);}};const fetchMilestones=useCallback(async projectId=>{try{const response=await axios.get(\"/api/milestones\",{params:{projectId}});const projectMilestones=response.data.filter(milestone=>milestone.projectId===projectId);setMilestones(projectMilestones);}catch(error){console.error('Error fetching milestones:',error);}},[]);useEffect(()=>{fetchCurrentUser();fetchMilestones(project.projectId);},[fetchMilestones,project]);const amountRaisedInEther=parseFloat(project.amountRaised);const fundingGoalInEther=project.fundingGoal/10**18;const handleBackClick=()=>{onClose(activePage);};const calculateFundingProgress=()=>{return amountRaisedInEther/fundingGoalInEther*100;};const calculateMilestoneProgress=()=>{const approvedMilestones=milestones.filter(milestone=>milestone.milestonestatus==='approved').length;return approvedMilestones/milestones.length*100;};return/*#__PURE__*/React.createElement(\"div\",{className:\"project-details-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"project-details\"},/*#__PURE__*/React.createElement(\"button\",{onClick:handleBackClick,className:\"back-button\"},\"Back\"),/*#__PURE__*/React.createElement(\"h2\",null,project.projectName),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"ID:\"),\" \",project.projectId),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Type:\"),\" \",project.projectType),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Description:\"),\" \",project.projectDescription),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Project Deadline:\"),\" \",new Date(project.projectDDL).toLocaleDateString()),project.status.toLowerCase()==='active'?/*#__PURE__*/React.createElement(\"div\",{className:\"status-section\"},/*#__PURE__*/React.createElement(\"p\",{className:\"project-status\"},\"Crowdfunding Project - Raised: \",amountRaisedInEther,\" / \",fundingGoalInEther,\" ETH\"),/*#__PURE__*/React.createElement(\"div\",{className:\"progress-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"progress\",style:{width:\"\".concat(calculateFundingProgress(),\"%\")}}))):/*#__PURE__*/React.createElement(\"div\",{className:\"milestone-section\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Milestones\"),/*#__PURE__*/React.createElement(\"ul\",null,milestones.map((milestone,index)=>/*#__PURE__*/React.createElement(\"li\",{key:\"\".concat(project.projectId,\"-\").concat(milestone.milestoneId,\"-\").concat(index)},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Milestone ID:\"),\" \",milestone.milestoneId+1),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Description:\"),\" \",milestone.milestoneDescription),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Document:\"),\" \",/*#__PURE__*/React.createElement(\"a\",{href:milestone.documentURL,target:\"_blank\",rel:\"noopener noreferrer\"},\"View Document\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"milestone-progress-container\"},milestones.map((milestone,index)=>{const milestoneStatus=milestone.milestonestatus;const isApproved=milestoneStatus==='approved';const isPending=milestoneStatus==='pending';return/*#__PURE__*/React.createElement(\"div\",{key:\"\".concat(project.projectId,\"-\").concat(milestone.milestoneId,\"-\").concat(index),className:\"milestone-progress \".concat(isApproved?'approved':isPending?'pending':'upcoming')});})),/*#__PURE__*/React.createElement(\"p\",{className:\"project-status\"},\"Milestone Progress - \",milestones.filter(m=>m.milestonestatus==='approved').length,\" of \",milestones.length,\" approved\")),project.status.toLowerCase()==='active'&&project.creator.toLowerCase()!==currentUser&&/*#__PURE__*/React.createElement(FundProject,{projectId:project.projectId}),project.status.toLowerCase()==='funded'&&project.creator.toLowerCase()===currentUser&&/*#__PURE__*/React.createElement(UserUploadProof,{projectId:project.projectId})));}export default ProjectDetails;","map":{"version":3,"names":["React","useEffect","useState","useCallback","axios","FundProject","UserUploadProof","ProjectDetails","_ref","project","onClose","activePage","milestones","setMilestones","currentUser","setCurrentUser","fetchCurrentUser","accounts","window","ethereum","request","method","toLowerCase","error","console","fetchMilestones","projectId","response","get","params","projectMilestones","data","filter","milestone","amountRaisedInEther","parseFloat","amountRaised","fundingGoalInEther","fundingGoal","handleBackClick","calculateFundingProgress","calculateMilestoneProgress","approvedMilestones","milestonestatus","length","createElement","className","onClick","projectName","projectType","projectDescription","Date","projectDDL","toLocaleDateString","status","style","width","concat","map","index","key","milestoneId","milestoneDescription","href","documentURL","target","rel","milestoneStatus","isApproved","isPending","m","creator"],"sources":["/Users/matrix/front-end/src/components/ProjectDetails/ProjectDetails.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport axios from 'axios';\nimport FundProject from '../FundProject/FundProject';\nimport UserUploadProof from '../UserUploadProof/UserUploadProof';\nimport './ProjectDetails.css';\n\nfunction ProjectDetails({ project, onClose, activePage }) {\n  const [milestones, setMilestones] = useState([]);\n  const [currentUser, setCurrentUser] = useState('');\n\n  const fetchCurrentUser = async () => {\n    try {\n      const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n      setCurrentUser(accounts[0].toLowerCase());\n    } catch (error) {\n      console.error('Error fetching current user:', error);\n    }\n  };\n\n  const fetchMilestones = useCallback(async (projectId) => {\n    try {\n      const response = await axios.get(`/api/milestones`, {\n        params: { projectId }\n      });\n      const projectMilestones = response.data.filter(milestone => milestone.projectId === projectId);\n      setMilestones(projectMilestones);\n    } catch (error) {\n      console.error('Error fetching milestones:', error);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchCurrentUser();\n    fetchMilestones(project.projectId);\n  }, [fetchMilestones, project]);\n\n  const amountRaisedInEther = parseFloat(project.amountRaised);\n  const fundingGoalInEther = project.fundingGoal / 10 ** 18;\n\n  const handleBackClick = () => {\n    onClose(activePage);\n  };\n\n  const calculateFundingProgress = () => {\n    return (amountRaisedInEther / fundingGoalInEther) * 100;\n  };\n\n  const calculateMilestoneProgress = () => {\n    const approvedMilestones = milestones.filter(milestone => milestone.milestonestatus === 'approved').length;\n    return (approvedMilestones / milestones.length) * 100;\n  };\n\n  return (\n    <div className=\"project-details-container\">\n      <div className=\"project-details\">\n        <button onClick={handleBackClick} className=\"back-button\">Back</button>\n        <h2>{project.projectName}</h2>\n        <p><strong>ID:</strong> {project.projectId}</p>\n        <p><strong>Type:</strong> {project.projectType}</p>\n        <p><strong>Description:</strong> {project.projectDescription}</p>\n        <p><strong>Project Deadline:</strong> {new Date(project.projectDDL).toLocaleDateString()}</p>\n\n        {project.status.toLowerCase() === 'active' ? (\n          <div className=\"status-section\">\n            <p className=\"project-status\">Crowdfunding Project - Raised: {amountRaisedInEther} / {fundingGoalInEther} ETH</p>\n            <div className=\"progress-bar\">\n              <div className=\"progress\" style={{ width: `${calculateFundingProgress()}%` }}></div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"milestone-section\">\n            <h3>Milestones</h3>\n            <ul>\n              {milestones.map((milestone, index) => (\n                <li key={`${project.projectId}-${milestone.milestoneId}-${index}`}>\n                  <p><strong>Milestone ID:</strong> {milestone.milestoneId + 1}</p>\n                  <p><strong>Description:</strong> {milestone.milestoneDescription}</p>\n                  <p><strong>Document:</strong> <a href={milestone.documentURL} target=\"_blank\" rel=\"noopener noreferrer\">View Document</a></p>\n                </li>\n              ))}\n            </ul>\n            <div className=\"milestone-progress-container\">\n              {milestones.map((milestone, index) => {\n                const milestoneStatus = milestone.milestonestatus;\n                const isApproved = milestoneStatus === 'approved';\n                const isPending = milestoneStatus === 'pending';\n                return (\n                  <div\n                    key={`${project.projectId}-${milestone.milestoneId}-${index}`}\n                    className={`milestone-progress ${isApproved ? 'approved' : isPending ? 'pending' : 'upcoming'}`}\n                  ></div>\n                );\n              })}\n            </div>\n            <p className=\"project-status\">Milestone Progress - {milestones.filter(m => m.milestonestatus === 'approved').length} of {milestones.length} approved</p>\n          </div>\n        )}\n\n        {project.status.toLowerCase() === 'active' && project.creator.toLowerCase() !== currentUser && (\n          <FundProject projectId={project.projectId} />\n        )}\n\n        {project.status.toLowerCase() === 'funded' && project.creator.toLowerCase() === currentUser && (\n          <UserUploadProof projectId={project.projectId} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default ProjectDetails;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}