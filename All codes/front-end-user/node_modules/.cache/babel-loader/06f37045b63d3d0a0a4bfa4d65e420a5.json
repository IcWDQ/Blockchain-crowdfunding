{"ast":null,"code":"var _jsxFileName = \"/Users/matrix/front-end/src/components/Home/Home.js\";\n// src/components/Home/Home.js\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { ethers } from 'ethers';\nimport Navbar from '../Navbar/Navbar';\nimport ProjectList from '../ProjectList/ProjectList';\nimport ProjectDetails from '../ProjectDetails/ProjectDetails';\nimport CreateProject from '../CreateProject/CreateProject';\nimport './Home.css';\nfunction Home() {\n  const [projects, setProjects] = useState([]);\n  const [filteredProjects, setFilteredProjects] = useState([]);\n  const [userAddress, setUserAddress] = useState('');\n  const [selectedProject, setSelectedProject] = useState(null);\n  const [activePage, setActivePage] = useState('allProjects');\n  useEffect(() => {\n    fetchProjects();\n    getUserAddress();\n  }, []);\n  useEffect(() => {\n    if (activePage === 'allProjects') {\n      setFilteredProjects(filterActiveAndFundedProjects());\n    } else if (activePage === 'fundedProjects') {\n      setFilteredProjects(filterFundedProjects());\n    } else if (activePage === 'myProjects') {\n      setFilteredProjects(filterMyProjects());\n    }\n  }, [projects, activePage, userAddress]);\n  const fetchProjects = async () => {\n    try {\n      const response = await axios.get('/api/projects');\n      setProjects(response.data);\n    } catch (error) {\n      console.error('Error fetching projects:', error);\n    }\n  };\n  const getUserAddress = async () => {\n    try {\n      await window.ethereum.request({\n        method: 'eth_requestAccounts'\n      });\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const address = await signer.getAddress();\n      setUserAddress(address);\n    } catch (error) {\n      console.error('Error getting user address:', error);\n    }\n  };\n  const filterMyProjects = () => {\n    return projects.filter(project => project.creator.toLowerCase() === userAddress.toLowerCase());\n  };\n  const filterFundedProjects = () => {\n    return projects.filter(project => (project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded') && project.contributors.some(contributor => contributor.toLowerCase() === userAddress.toLowerCase()));\n  };\n  const filterActiveAndFundedProjects = () => {\n    return projects.filter(project => project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded');\n  };\n  const toggleCreateProject = () => {\n    setActivePage('createProject');\n    setSelectedProject(null);\n  };\n  const showAllProjects = () => {\n    setActivePage('allProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n  const showMyProjects = () => {\n    setActivePage('myProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n  const showFundedProjects = () => {\n    setActivePage('fundedProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n  const handleProjectClick = project => {\n    setSelectedProject({\n      ...project,\n      isCreator: project.creator.toLowerCase() === userAddress.toLowerCase()\n    });\n    setActivePage('projectDetails');\n  };\n  const handleBackToProjects = () => {\n    setSelectedProject(null);\n    setActivePage('allProjects');\n  };\n  const handleSearch = term => {\n    let projectsToFilter = projects;\n    if (activePage === 'myProjects') {\n      projectsToFilter = filterMyProjects();\n    } else if (activePage === 'fundedProjects') {\n      projectsToFilter = filterFundedProjects();\n    } else if (activePage === 'allProjects') {\n      projectsToFilter = filterActiveAndFundedProjects();\n    }\n    if (!term) {\n      setFilteredProjects(projectsToFilter);\n    } else {\n      const lowercasedTerm = term.toLowerCase();\n      const filtered = projectsToFilter.filter(project => project.projectName.toLowerCase().includes(lowercasedTerm) || project.projectId.toString() === term // 精确匹配ID\n      );\n      setFilteredProjects(filtered);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"home-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    onCreateProject: toggleCreateProject,\n    onShowAllProjects: showAllProjects,\n    onShowMyProjects: showMyProjects,\n    onShowFundedProjects: showFundedProjects,\n    onSearch: handleSearch,\n    activePage: activePage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: `content ${activePage === 'createProject' ? 'centered' : ''}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }, selectedProject ? /*#__PURE__*/React.createElement(ProjectDetails, {\n    project: selectedProject,\n    onClose: handleBackToProjects,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 11\n    }\n  }) : activePage === 'createProject' ? /*#__PURE__*/React.createElement(CreateProject, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(ProjectList, {\n    projects: filteredProjects,\n    onProjectClick: handleProjectClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 11\n    }\n  })));\n}\nexport default Home;","map":{"version":3,"names":["React","useState","useEffect","axios","ethers","Navbar","ProjectList","ProjectDetails","CreateProject","Home","projects","setProjects","filteredProjects","setFilteredProjects","userAddress","setUserAddress","selectedProject","setSelectedProject","activePage","setActivePage","fetchProjects","getUserAddress","filterActiveAndFundedProjects","filterFundedProjects","filterMyProjects","response","get","data","error","console","window","ethereum","request","method","provider","providers","Web3Provider","signer","getSigner","address","getAddress","filter","project","creator","toLowerCase","status","contributors","some","contributor","toggleCreateProject","showAllProjects","showMyProjects","showFundedProjects","handleProjectClick","isCreator","handleBackToProjects","handleSearch","term","projectsToFilter","lowercasedTerm","filtered","projectName","includes","projectId","toString","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onCreateProject","onShowAllProjects","onShowMyProjects","onShowFundedProjects","onSearch","onClose","onProjectClick"],"sources":["/Users/matrix/front-end/src/components/Home/Home.js"],"sourcesContent":["// src/components/Home/Home.js\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { ethers } from 'ethers';\nimport Navbar from '../Navbar/Navbar';\nimport ProjectList from '../ProjectList/ProjectList';\nimport ProjectDetails from '../ProjectDetails/ProjectDetails';\nimport CreateProject from '../CreateProject/CreateProject';\nimport './Home.css';\n\nfunction Home() {\n  const [projects, setProjects] = useState([]);\n  const [filteredProjects, setFilteredProjects] = useState([]);\n  const [userAddress, setUserAddress] = useState('');\n  const [selectedProject, setSelectedProject] = useState(null);\n  const [activePage, setActivePage] = useState('allProjects');\n\n  useEffect(() => {\n    fetchProjects();\n    getUserAddress();\n  }, []);\n\n  useEffect(() => {\n    if (activePage === 'allProjects') {\n      setFilteredProjects(filterActiveAndFundedProjects());\n    } else if (activePage === 'fundedProjects') {\n      setFilteredProjects(filterFundedProjects());\n    } else if (activePage === 'myProjects') {\n      setFilteredProjects(filterMyProjects());\n    }\n  }, [projects, activePage, userAddress]);\n\n  const fetchProjects = async () => {\n    try {\n      const response = await axios.get('/api/projects');\n      setProjects(response.data);\n    } catch (error) {\n      console.error('Error fetching projects:', error);\n    }\n  };\n\n  const getUserAddress = async () => {\n    try {\n      await window.ethereum.request({ method: 'eth_requestAccounts' });\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const address = await signer.getAddress();\n      setUserAddress(address);\n    } catch (error) {\n      console.error('Error getting user address:', error);\n    }\n  };\n\n  const filterMyProjects = () => {\n    return projects.filter(project => project.creator.toLowerCase() === userAddress.toLowerCase());\n  };\n\n  const filterFundedProjects = () => {\n    return projects.filter(project => \n      (project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded') &&\n      project.contributors.some(contributor => contributor.toLowerCase() === userAddress.toLowerCase())\n    );\n  };\n\n  const filterActiveAndFundedProjects = () => {\n    return projects.filter(project => \n      project.status.toLowerCase() === 'active' || project.status.toLowerCase() === 'funded'\n    );\n  };\n\n  const toggleCreateProject = () => {\n    setActivePage('createProject');\n    setSelectedProject(null);\n  };\n\n  const showAllProjects = () => {\n    setActivePage('allProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n\n  const showMyProjects = () => {\n    setActivePage('myProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n\n  const showFundedProjects = () => {\n    setActivePage('fundedProjects');\n    setSelectedProject(null); // Ensure ProjectDetails is closed\n  };\n\n  const handleProjectClick = (project) => {\n    setSelectedProject({\n      ...project,\n      isCreator: project.creator.toLowerCase() === userAddress.toLowerCase()\n    });\n    setActivePage('projectDetails');\n  };\n\n  const handleBackToProjects = () => {\n    setSelectedProject(null);\n    setActivePage('allProjects');\n  };\n\n  const handleSearch = (term) => {\n    let projectsToFilter = projects;\n    if (activePage === 'myProjects') {\n      projectsToFilter = filterMyProjects();\n    } else if (activePage === 'fundedProjects') {\n      projectsToFilter = filterFundedProjects();\n    } else if (activePage === 'allProjects') {\n      projectsToFilter = filterActiveAndFundedProjects();\n    }\n\n    if (!term) {\n      setFilteredProjects(projectsToFilter);\n    } else {\n      const lowercasedTerm = term.toLowerCase();\n      const filtered = projectsToFilter.filter(project =>\n        project.projectName.toLowerCase().includes(lowercasedTerm) ||\n        project.projectId.toString() === term // 精确匹配ID\n      );\n      setFilteredProjects(filtered);\n    }\n  };\n\n  return (\n    <div className=\"home-container\">\n      <Navbar \n        onCreateProject={toggleCreateProject} \n        onShowAllProjects={showAllProjects} \n        onShowMyProjects={showMyProjects}\n        onShowFundedProjects={showFundedProjects}\n        onSearch={handleSearch}\n        activePage={activePage}\n      />\n      <div className={`content ${activePage === 'createProject' ? 'centered' : ''}`}>\n        {selectedProject ? (\n          <ProjectDetails project={selectedProject} onClose={handleBackToProjects} />\n        ) : activePage === 'createProject' ? (\n          <CreateProject />\n        ) : (\n          <ProjectList projects={filteredProjects} onProjectClick={handleProjectClick} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Home;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}